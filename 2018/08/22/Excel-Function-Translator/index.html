<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quicksand:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;charlesmacaron.github.io&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Gemini&quot;,&quot;version&quot;:&quot;8.5.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:false,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:true,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;Searching...&quot;,&quot;empty&quot;:&quot;We didn&#39;t find any results for the search: ${query}&quot;,&quot;hits_time&quot;:&quot;${hits} results found in ${time} ms&quot;,&quot;hits&quot;:&quot;${hits} results found&quot;}}</script><script src="/js/config.js"></script>
<meta name="description" content="The purpose of Excel Function Translator is to search and view Microsoft Excel functions and descriptions in different languages. I am fond of using MacBook as a French language learning tool. However">
<meta property="og:type" content="article">
<meta property="og:title" content="Excel Function Translator">
<meta property="og:url" content="https://charlesmacaron.github.io/2018/08/22/Excel-Function-Translator/index.html">
<meta property="og:site_name" content="Le Blog du Macaron">
<meta property="og:description" content="The purpose of Excel Function Translator is to search and view Microsoft Excel functions and descriptions in different languages. I am fond of using MacBook as a French language learning tool. However">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://github.com/charlesmacaron/ExcelFunctionTranslator/blob/main/screenshots/screenshot.png?raw=true">
<meta property="article:published_time" content="2018-08-22T12:15:35.000Z">
<meta property="article:modified_time" content="2021-06-17T02:55:52.668Z">
<meta property="article:author" content="Xinyu Zhao (Charles)">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Excel">
<meta property="article:tag" content="Requests">
<meta property="article:tag" content="BeautifulSoup4">
<meta property="article:tag" content="colorama">
<meta property="article:tag" content="progress">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/charlesmacaron/ExcelFunctionTranslator/blob/main/screenshots/screenshot.png?raw=true">


<link rel="canonical" href="https://charlesmacaron.github.io/2018/08/22/Excel-Function-Translator/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;en&quot;,&quot;comments&quot;:true,&quot;permalink&quot;:&quot;https:&#x2F;&#x2F;charlesmacaron.github.io&#x2F;2018&#x2F;08&#x2F;22&#x2F;Excel-Function-Translator&#x2F;&quot;,&quot;path&quot;:&quot;2018&#x2F;08&#x2F;22&#x2F;Excel-Function-Translator&#x2F;&quot;,&quot;title&quot;:&quot;Excel Function Translator&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>Excel Function Translator | Le Blog du Macaron</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Le Blog du Macaron</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="https://github.com/charlesmacaron" rel="noopener" target="_blank"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#User-Interaction-Design"><span class="nav-number">1.</span> <span class="nav-text">User Interaction Design</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Python-Standard-Modules"><span class="nav-number">2.</span> <span class="nav-text">Python Standard Modules</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Python-External-Packages"><span class="nav-number">3.</span> <span class="nav-text">Python External Packages</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Output-Beautiful-Program-Title"><span class="nav-number">4.</span> <span class="nav-text">Output Beautiful Program Title</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Initialize-the-Program"><span class="nav-number">5.</span> <span class="nav-text">Initialize the Program</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Let-Users-Choose-Languages"><span class="nav-number">6.</span> <span class="nav-text">Let Users Choose Languages</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-Main-Loop-of-Program"><span class="nav-number">7.</span> <span class="nav-text">The Main Loop of Program</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Accumulate-Knowledge"><span class="nav-number">8.</span> <span class="nav-text">Accumulate Knowledge</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#References"><span class="nav-number">9.</span> <span class="nav-text">References</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Xinyu Zhao (Charles)"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Xinyu Zhao (Charles)</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/charlesmacaron" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;charlesmacaron" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:charles.macaron.io@gmail.com" title="E-Mail → mailto:charles.macaron.io@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/charlesmacaron" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://charlesmacaron.github.io/2018/08/22/Excel-Function-Translator/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Xinyu Zhao (Charles)">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Le Blog du Macaron">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Excel Function Translator
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2018-08-22 08:15:35" itemprop="dateCreated datePublished" datetime="2018-08-22T08:15:35-04:00">2018-08-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-06-16 22:55:52" itemprop="dateModified" datetime="2021-06-16T22:55:52-04:00">2021-06-16</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>The purpose of <a target="_blank" rel="noopener" href="https://github.com/charlesmacaron/ExcelFunctionTranslator">Excel Function Translator</a> is to search and view Microsoft Excel functions and descriptions in different languages.</p>
<p>I am fond of using MacBook as a French language learning tool. However, I have not found a way to use English Excel functions in French macOS environment. For instance, <code>TODAY()</code> can only be used in English environment, while <code>AUJOURDHUI()</code> can only be used in French environment. Due to this contradiction, I created the Excel Function Translator.</p>
<p><img src="https://github.com/charlesmacaron/ExcelFunctionTranslator/blob/main/screenshots/screenshot.png?raw=true" alt="Screenshot"></p>
<h1 id="User-Interaction-Design"><a href="#User-Interaction-Design" class="headerlink" title="User Interaction Design"></a>User Interaction Design</h1><p>The process of this program is quite simple:</p>
<ol>
<li>collect data from the internet,</li>
<li>let users choose the languages,</li>
<li>let users look up any Excel functions in source language, and</li>
<li>display the corresponding Excel function with description in destination language.</li>
</ol>
<h1 id="Python-Standard-Modules"><a href="#Python-Standard-Modules" class="headerlink" title="Python Standard Modules"></a>Python Standard Modules</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> sys</span><br></pre></td></tr></table></figure>

<h1 id="Python-External-Packages"><a href="#Python-External-Packages" class="headerlink" title="Python External Packages"></a>Python External Packages</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> colorama <span class="keyword">import</span> Back, Fore, Style, init</span><br><span class="line"><span class="keyword">from</span> progress.bar <span class="keyword">import</span> Bar</span><br></pre></td></tr></table></figure>

<p>Generally, the packages above have to be installed before importing them.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install requests, beautifulsoup4, colorama, progress</span><br></pre></td></tr></table></figure>

<h1 id="Output-Beautiful-Program-Title"><a href="#Output-Beautiful-Program-Title" class="headerlink" title="Output Beautiful Program Title"></a>Output Beautiful Program Title</h1><p>For Windows users, it is necessary to initialize the environment for colorama. However, it is not necessary for macOS users.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">init()</span><br></pre></td></tr></table></figure>
<p>Use <code>Fore.COLORNAME</code> to control font color, and use <code>Back.COLORNAME</code> to control background color.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(Fore.BLACK + Back.CYAN + <span class="string">&#x27;E&#x27;</span> + Style.RESET_ALL + Fore.WHITE + <span class="string">&#x27;xcel &#x27;</span>, </span><br><span class="line">end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(Fore.BLACK + Back.CYAN + <span class="string">&#x27;F&#x27;</span> + Style.RESET_ALL + Fore.WHITE + <span class="string">&#x27;unction &#x27;</span>, </span><br><span class="line">end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(Fore.BLACK + Back.CYAN + <span class="string">&#x27;T&#x27;</span> + Style.RESET_ALL + Fore.WHITE + <span class="string">&#x27;ranslator&#x27;</span> </span><br><span class="line">+ Fore.CYAN)</span><br></pre></td></tr></table></figure>

<h1 id="Initialize-the-Program"><a href="#Initialize-the-Program" class="headerlink" title="Initialize the Program"></a>Initialize the Program</h1><p>Create a progress bar to indicate the initialization progress.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bar = Bar(<span class="string">&#x27;Initializing&#x27;</span>, fill=<span class="string">&#x27;█&#x27;</span>, suffix=<span class="string">&#x27;%(percent)d%%&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>Remove and create html folder and json folder in order to use latest data.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&#x27;html&#x27;</span>):</span><br><span class="line">    shutil.rmtree(<span class="string">&#x27;html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&#x27;json&#x27;</span>):</span><br><span class="line">    shutil.rmtree(<span class="string">&#x27;json&#x27;</span>)</span><br><span class="line"></span><br><span class="line">os.mkdir(<span class="string">&#x27;html&#x27;</span>)</span><br><span class="line">os.mkdir(<span class="string">&#x27;json&#x27;</span>)</span><br><span class="line"></span><br><span class="line">bar.<span class="built_in">next</span>() <span class="comment"># Progress bar for cleaning and creating external files</span></span><br></pre></td></tr></table></figure>

<p>Request html page from the internet and save it in local html folder. Actually, if there is no other consideration of the html file, it is not essential to save the html file in local folder.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">responseObject = requests.get(<span class="string">&#x27;http://dolf.trieschnigg.nl/excel/index.php&#x27;</span>)</span><br><span class="line"></span><br><span class="line">file = <span class="built_in">open</span>(os.path.join(<span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>), <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">file.writelines(responseObject.text)</span><br><span class="line">file.close()</span><br><span class="line"></span><br><span class="line">bar.<span class="built_in">next</span>() <span class="comment"># Progress bar for collecting index.html</span></span><br></pre></td></tr></table></figure>

<p>Use <code>BeautifulSoup4</code> to parse <code>index.html</code> so that the computer can know what the program wants from the web page.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">soup = BeautifulSoup(<span class="built_in">open</span>(os.path.join(<span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>), encoding=<span class="string">&#x27;UTF-8&#x27;</span></span><br><span class="line">), <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line"></span><br><span class="line">bar.<span class="built_in">next</span>() <span class="comment"># Progress bar for parsing index.html</span></span><br></pre></td></tr></table></figure>

<p>Count the number of languages.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dictionary = &#123;&#125;</span><br><span class="line">languages = []</span><br><span class="line">jsonfiles = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> content <span class="keyword">in</span> soup.find_all(<span class="string">&#x27;th&#x27;</span>):</span><br><span class="line">    dictionary[content.get(<span class="string">&#x27;langid&#x27;</span>)] = &#123;&#125;</span><br><span class="line">    languages.append(content.get(<span class="string">&#x27;langid&#x27;</span>))</span><br><span class="line"></span><br><span class="line">bar.<span class="built_in">next</span>() <span class="comment"># Progress bar for counting the number of languages</span></span><br></pre></td></tr></table></figure>

<p>Save all html files in html folder, import Excel functions from html files in html folder, and then create language specific json files.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> content <span class="keyword">in</span> soup.find_all(<span class="string">&#x27;th&#x27;</span>):</span><br><span class="line">    dictionary[content.get(<span class="string">&#x27;langid&#x27;</span>)][<span class="string">&#x27;name&#x27;</span>] = content.get_text()</span><br><span class="line">    dictionary[content.get(<span class="string">&#x27;langid&#x27;</span>)][<span class="string">&#x27;langid&#x27;</span>] = content.get(<span class="string">&#x27;langid&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> content.find(<span class="string">&#x27;a&#x27;</span>) != <span class="literal">None</span>:</span><br><span class="line">        dictionary[content.get(</span><br><span class="line">            <span class="string">&#x27;langid&#x27;</span>)][<span class="string">&#x27;link&#x27;</span>] = <span class="string">&#x27;http://dolf.trieschnigg.nl/excel/&#x27;</span> + </span><br><span class="line">            content.find(<span class="string">&#x27;a&#x27;</span>).get(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">        dictionary[content.get(<span class="string">&#x27;langid&#x27;</span>)][<span class="string">&#x27;json&#x27;</span>] = content.get(</span><br><span class="line">            <span class="string">&#x27;langid&#x27;</span>) + <span class="string">&#x27;.json&#x27;</span></span><br><span class="line">        responseObject = requests.get(</span><br><span class="line">            dictionary[content.get(<span class="string">&#x27;langid&#x27;</span>)][<span class="string">&#x27;link&#x27;</span>])</span><br><span class="line">        jsonfiles.append(content.get(<span class="string">&#x27;langid&#x27;</span>))</span><br><span class="line">        file = <span class="built_in">open</span>(os.path.join(<span class="string">&#x27;html&#x27;</span>, content.get(</span><br><span class="line">            <span class="string">&#x27;langid&#x27;</span>) + <span class="string">&#x27;.html&#x27;</span>), <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">        file.writelines(responseObject.text)</span><br><span class="line">        file.close()</span><br><span class="line">        file = <span class="built_in">open</span>(os.path.join(<span class="string">&#x27;json&#x27;</span>, content.get(</span><br><span class="line">            <span class="string">&#x27;langid&#x27;</span>) + <span class="string">&#x27;.json&#x27;</span>), <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">        file.close()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dictionary[content.get(<span class="string">&#x27;langid&#x27;</span>)][<span class="string">&#x27;link&#x27;</span>] = <span class="string">&#x27;None&#x27;</span></span><br><span class="line">        dictionary[content.get(<span class="string">&#x27;langid&#x27;</span>)][<span class="string">&#x27;json&#x27;</span>] = <span class="string">&#x27;None&#x27;</span></span><br><span class="line">    bar.<span class="built_in">next</span>(<span class="number">3</span>)  <span class="comment"># Progress bar for all html files and json files</span></span><br><span class="line">file = <span class="built_in">open</span>(os.path.join(<span class="string">&#x27;json&#x27;</span>, <span class="string">&#x27;structure.json&#x27;</span>), <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">file.write(json.dumps(dictionary))</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure>

<p>Save all Excel functions from <code>index.html</code> to <code>index.json</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">dictionary.clear()</span><br><span class="line"><span class="keyword">for</span> content <span class="keyword">in</span> soup.find_all(<span class="string">&#x27;tr&#x27;</span>):</span><br><span class="line">    dictionary[content.find(<span class="string">&#x27;td&#x27;</span>).get_text()] = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> soup.find_all(<span class="string">&#x27;tr&#x27;</span>):</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> content <span class="keyword">in</span> row.find_all(<span class="string">&#x27;td&#x27;</span>):</span><br><span class="line">        dictionary[row.find(<span class="string">&#x27;td&#x27;</span>).get_text()</span><br><span class="line">                   ][languages[count]] = content.get_text()</span><br><span class="line">        count = count + <span class="number">1</span></span><br><span class="line">file = <span class="built_in">open</span>(os.path.join(<span class="string">&#x27;json&#x27;</span>, <span class="string">&#x27;index.json&#x27;</span>), <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">file.write(json.dumps(dictionary))</span><br><span class="line">file.close()</span><br><span class="line"></span><br><span class="line">bar.<span class="built_in">next</span>()  <span class="comment"># Progress bar for saving all Excel functions</span></span><br></pre></td></tr></table></figure>

<p>Save Excel functions and descriptions in language specific json files.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> jsonfile <span class="keyword">in</span> jsonfiles:</span><br><span class="line">    soup = BeautifulSoup(</span><br><span class="line">        <span class="built_in">open</span>(os.path.join(<span class="string">&#x27;html&#x27;</span>, jsonfile + <span class="string">&#x27;.html&#x27;</span>), encoding=<span class="string">&#x27;UTF-8&#x27;</span>), </span><br><span class="line">        <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    dictionary.clear()</span><br><span class="line">    <span class="keyword">for</span> content <span class="keyword">in</span> soup.find_all(<span class="string">&#x27;tr&#x27;</span>):</span><br><span class="line">        dictionary[content.find_all(<span class="string">&#x27;td&#x27;</span>)[<span class="number">2</span>].get_text()] = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> content <span class="keyword">in</span> soup.find_all(<span class="string">&#x27;tr&#x27;</span>):</span><br><span class="line">        dictionary[content.find_all(<span class="string">&#x27;td&#x27;</span>)[<span class="number">2</span>].get_text(</span><br><span class="line">        )][jsonfile] = content.find_all(<span class="string">&#x27;td&#x27;</span>)[<span class="number">0</span>].get_text()</span><br><span class="line">        dictionary[content.find_all(<span class="string">&#x27;td&#x27;</span>)[<span class="number">2</span>].get_text(</span><br><span class="line">        )][jsonfile + <span class="string">&#x27;_description&#x27;</span>] = content.find_all(<span class="string">&#x27;td&#x27;</span>)[<span class="number">1</span>].get_text()</span><br><span class="line">        dictionary[content.find_all(<span class="string">&#x27;td&#x27;</span>)[<span class="number">2</span>].get_text(</span><br><span class="line">        )][<span class="string">&#x27;en_description&#x27;</span>] = content.find_all(<span class="string">&#x27;td&#x27;</span>)[<span class="number">3</span>].get_text()</span><br><span class="line">    file = <span class="built_in">open</span>(os.path.join(<span class="string">&#x27;json&#x27;</span>, jsonfile + <span class="string">&#x27;.json&#x27;</span>),</span><br><span class="line">                <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">    file.write(json.dumps(dictionary))</span><br><span class="line">    file.close()</span><br><span class="line"></span><br><span class="line">    bar.<span class="built_in">next</span>(<span class="number">3</span>)  <span class="comment"># Progress bar for each language specific json file</span></span><br></pre></td></tr></table></figure>

<p>Remove html folder, if it is not required.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&#x27;html&#x27;</span>):</span><br><span class="line">    shutil.rmtree(<span class="string">&#x27;html&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>Complete, conceal and destroy the progress bar.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bar.<span class="built_in">next</span>(bar.remaining)</span><br><span class="line">bar.clearln()</span><br><span class="line">bar.finish()</span><br></pre></td></tr></table></figure>

<h1 id="Let-Users-Choose-Languages"><a href="#Let-Users-Choose-Languages" class="headerlink" title="Let Users Choose Languages"></a>Let Users Choose Languages</h1><p>Display language list with language code for users</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">file = <span class="built_in">open</span>(os.path.join(<span class="string">&#x27;json&#x27;</span>, <span class="string">&#x27;structure.json&#x27;</span>), <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">dictionary = json.loads(file.read(), encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">file.close()</span><br><span class="line"><span class="built_in">print</span>(Fore.WHITE + Back.BLUE + <span class="built_in">str</span>(<span class="string">&#x27;Language&#x27;</span>).ljust(<span class="number">20</span>) + <span class="built_in">str</span>(<span class="string">&#x27;Code&#x27;</span>).ljust(<span class="number">10</span></span><br><span class="line">), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(<span class="string">&#x27;Language&#x27;</span>).ljust(<span class="number">20</span>) + <span class="built_in">str</span>(<span class="string">&#x27;Code&#x27;</span>).ljust(<span class="number">10</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(<span class="string">&#x27;Language&#x27;</span>).ljust(<span class="number">20</span>) + <span class="built_in">str</span>(<span class="string">&#x27;Code&#x27;</span>).ljust(<span class="number">10</span>) + Style.RESET_ALL)</span><br><span class="line"><span class="built_in">print</span>(Fore.BLUE + <span class="string">&#x27;-&#x27;</span> * <span class="number">90</span>)</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> content <span class="keyword">in</span> dictionary:</span><br><span class="line">    <span class="keyword">if</span> dictionary[content][<span class="string">&#x27;json&#x27;</span>] == <span class="string">&#x27;None&#x27;</span> <span class="keyword">and</span> </span><br><span class="line">    dictionary[content][<span class="string">&#x27;langid&#x27;</span>] != <span class="string">&#x27;en&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(Fore.WHITE + <span class="built_in">str</span>((dictionary[content][<span class="string">&#x27;name&#x27;</span>]).split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        ).ljust(<span class="number">20</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(Fore.WHITE + <span class="built_in">str</span>(dictionary[content][<span class="string">&#x27;langid&#x27;</span>]).ljust(<span class="number">10</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(Fore.GREEN + <span class="built_in">str</span>((dictionary[content][<span class="string">&#x27;name&#x27;</span>]).split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        ).ljust(<span class="number">20</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(Fore.MAGENTA + <span class="built_in">str</span>(dictionary[content][<span class="string">&#x27;langid&#x27;</span>]).ljust(<span class="number">10</span>), </span><br><span class="line">        end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> count == <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">        <span class="built_in">print</span>(Fore.BLUE + <span class="string">&#x27;-&#x27;</span> * <span class="number">90</span>)</span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        count = count + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(Fore.BLUE + <span class="string">&#x27;-&#x27;</span> * <span class="number">90</span>)</span><br><span class="line"><span class="built_in">print</span>(Fore.WHITE + Back.BLUE +</span><br><span class="line">      <span class="built_in">str</span>(<span class="string">&#x27;Note: There is no description for languages in white.&#x27;</span>).ljust(<span class="number">90</span>))</span><br><span class="line"><span class="built_in">print</span>(Style.RESET_ALL)</span><br></pre></td></tr></table></figure>

<p>Ask users for languages for both source language (for searching) and destination language (for showing the result), and always check the validity.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(Fore.CYAN + <span class="string">&#x27;&gt;&gt; Code of language for &#x27;</span> + Fore.WHITE + Back.CYAN +</span><br><span class="line">      <span class="string">&#x27;search&#x27;</span> + Style.RESET_ALL + Fore.CYAN + <span class="string">&#x27;: &#x27;</span> + Fore.YELLOW, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">searchLanguage = <span class="built_in">str</span>(<span class="built_in">input</span>()).lower()[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line"><span class="keyword">while</span> searchLanguage <span class="keyword">not</span> <span class="keyword">in</span> dictionary:</span><br><span class="line">    <span class="built_in">print</span>(Fore.RED + </span><br><span class="line">    <span class="string">&#x27;It seems that there is no match for the code...please try again:)&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(Fore.CYAN + <span class="string">&#x27;&gt;&gt; Code of language for &#x27;</span> + Fore.WHITE + Back.CYAN +</span><br><span class="line">          <span class="string">&#x27;search&#x27;</span> + Style.RESET_ALL + Fore.CYAN + <span class="string">&#x27;: &#x27;</span> + Fore.YELLOW, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    searchLanguage = <span class="built_in">str</span>(<span class="built_in">input</span>()).lower()[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line"><span class="built_in">print</span>(Fore.CYAN + <span class="string">&#x27;&gt;&gt; Code of language for &#x27;</span> + Fore.WHITE + Back.CYAN +</span><br><span class="line">      <span class="string">&#x27;result&#x27;</span> + Style.RESET_ALL + Fore.CYAN + <span class="string">&#x27;: &#x27;</span> + Fore.YELLOW, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">resultLanguage = <span class="built_in">str</span>(<span class="built_in">input</span>()).lower()[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line"><span class="keyword">while</span> searchLanguage <span class="keyword">not</span> <span class="keyword">in</span> dictionary:</span><br><span class="line">    <span class="built_in">print</span>(Fore.RED + </span><br><span class="line">    <span class="string">&#x27;It seems that there is no match for the code...please try again:)&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(Fore.CYAN + <span class="string">&#x27;&gt;&gt; Code of language for &#x27;</span> + Fore.WHITE + Back.CYAN +</span><br><span class="line">          <span class="string">&#x27;result&#x27;</span> + Style.RESET_ALL + Fore.CYAN + <span class="string">&#x27;: &#x27;</span> + Fore.YELLOW, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    resultLanguage = <span class="built_in">str</span>(<span class="built_in">input</span>()).lower()[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">searchJsonFile = dictionary[searchLanguage][<span class="string">&#x27;json&#x27;</span>]</span><br><span class="line">resultJsonFile = dictionary[resultLanguage][<span class="string">&#x27;json&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>

<p>Display instructions in terminal</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(Fore.CYAN + <span class="string">&#x27;Instructions&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(Fore.CYAN + <span class="string">&#x27;==&gt; Press letter(s) with Enter to see close functions&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(Fore.CYAN + <span class="string">&#x27;==&gt; Press QUIT with Enter to quit at any time&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(Style.RESET_ALL)</span><br></pre></td></tr></table></figure>

<p>Import language specific data from json files</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">searchDictionary = &#123;&#125;</span><br><span class="line">resultDictionary = &#123;&#125;</span><br><span class="line">file = <span class="built_in">open</span>(os.path.join(<span class="string">&#x27;json&#x27;</span>, <span class="string">&#x27;index.json&#x27;</span>), <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">searchDictionary = json.loads(file.read(), encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">file.close()</span><br><span class="line"><span class="keyword">if</span> resultLanguage == <span class="string">&#x27;en&#x27;</span>:</span><br><span class="line">    file = <span class="built_in">open</span>(os.path.join(<span class="string">&#x27;json&#x27;</span>, <span class="string">&#x27;fr.json&#x27;</span>), <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">    resultDictionary = json.loads(file.read())</span><br><span class="line">    file.close()</span><br><span class="line"><span class="keyword">elif</span> resultJsonFile == <span class="string">&#x27;None&#x27;</span>:</span><br><span class="line">    resultDictionary = <span class="literal">None</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    file = <span class="built_in">open</span>(os.path.join(<span class="string">&#x27;json&#x27;</span>, resultJsonFile), <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">    resultDictionary = json.loads(file.read(), encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">    file.close()</span><br></pre></td></tr></table></figure>

<h1 id="The-Main-Loop-of-Program"><a href="#The-Main-Loop-of-Program" class="headerlink" title="The Main Loop of Program"></a>The Main Loop of Program</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">functions = []</span><br><span class="line">indexFunction = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    functions.clear()</span><br><span class="line">    <span class="built_in">print</span>(Fore.YELLOW + <span class="string">&#x27;&gt;&gt; &#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    userInput = <span class="built_in">str</span>(<span class="built_in">input</span>()).upper()</span><br><span class="line">    <span class="keyword">if</span> userInput == <span class="string">&#x27;QUIT&#x27;</span>:</span><br><span class="line">        sys.exit()</span><br><span class="line">    <span class="keyword">for</span> function <span class="keyword">in</span> searchDictionary:</span><br><span class="line">        <span class="keyword">if</span> userInput == searchDictionary[function][searchLanguage]:</span><br><span class="line">            functions.clear()</span><br><span class="line">            functions.append(searchDictionary[function][searchLanguage])</span><br><span class="line">            indexFunction = searchDictionary[function][<span class="string">&#x27;en&#x27;</span>]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">str</span>(searchDictionary[function][searchLanguage]).find(userInput</span><br><span class="line">        ) == <span class="number">0</span>:</span><br><span class="line">            functions.append(searchDictionary[function][searchLanguage])</span><br><span class="line">            indexFunction = searchDictionary[function][<span class="string">&#x27;en&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(functions) &lt; <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(Fore.RED + </span><br><span class="line">        <span class="string">&#x27;It seems that there is no match for the letter(s)...please try again:)&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">len</span>(functions) != <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(Fore.CYAN + <span class="built_in">str</span>(functions))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(Fore.MAGENTA + searchLanguage.upper() +</span><br><span class="line">              <span class="string">&#x27;: &#x27;</span> + Fore.GREEN + <span class="built_in">str</span>(functions[<span class="number">0</span>]))</span><br><span class="line">        <span class="built_in">print</span>(Fore.MAGENTA + resultLanguage.upper() + <span class="string">&#x27;: &#x27;</span> + Fore.GREEN +</span><br><span class="line">              <span class="built_in">str</span>(searchDictionary[indexFunction][resultLanguage]))</span><br><span class="line">        <span class="keyword">if</span> resultDictionary != <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> resultLanguage == <span class="string">&#x27;en&#x27;</span> <span class="keyword">and</span> indexFunction <span class="keyword">in</span> resultDictionary:</span><br><span class="line">                <span class="built_in">print</span>(Fore.MAGENTA + <span class="string">&#x27;DESCRIPTION: &#x27;</span> + Fore.GREEN +</span><br><span class="line">                      <span class="built_in">str</span>(resultDictionary[indexFunction][<span class="string">&#x27;en_description&#x27;</span>]))</span><br><span class="line">            <span class="keyword">elif</span> indexFunction <span class="keyword">in</span> resultDictionary:</span><br><span class="line">                <span class="built_in">print</span>(Fore.MAGENTA + <span class="string">&#x27;DESCRIPTION: &#x27;</span> + Fore.GREEN +</span><br><span class="line">                      <span class="built_in">str</span>(resultDictionary[indexFunction][resultLanguage + </span><br><span class="line">                      <span class="string">&#x27;_description&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<h1 id="Accumulate-Knowledge"><a href="#Accumulate-Knowledge" class="headerlink" title="Accumulate Knowledge"></a>Accumulate Knowledge</h1><p>An elegant quit is significant. If <code>Ctrl + C</code> is in need, always remember to rewrite system output.</p>
<p>For <code>Windows</code> platform, it is important to add <code>encoding=&#39;UTF-8</code> for every <code>print()</code>, <code>open()</code>, <code>json.dumps()</code>, and <code>json.loads()</code> to avoid chaos.</p>
<p><code>colorama</code> is not so compatible with <code>Windows</code>, so avoid using it in <code>input()</code>.</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ol>
<li>colorama: <a target="_blank" rel="noopener" href="https://pypi.org/project/colorama">https://pypi.org/project/colorama</a></li>
<li>progress: <a target="_blank" rel="noopener" href="https://pypi.org/project/progress">https://pypi.org/project/progress</a></li>
<li>Excel functions and descriptions in different language: <a target="_blank" rel="noopener" href="http://dolf.trieschnigg.nl/excel">http://dolf.trieschnigg.nl/excel</a></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Python/" rel="tag"># Python</a>
              <a href="/tags/Excel/" rel="tag"># Excel</a>
              <a href="/tags/Requests/" rel="tag"># Requests</a>
              <a href="/tags/BeautifulSoup4/" rel="tag"># BeautifulSoup4</a>
              <a href="/tags/colorama/" rel="tag"># colorama</a>
              <a href="/tags/progress/" rel="tag"># progress</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/2019/12/19/Compile-Assembly-Language-Code-on-macOS/" rel="next" title="Compile Assembly Language Code on macOS">
                  Compile Assembly Language Code on macOS <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xinyu Zhao (Charles)</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
